zabbix_export:
  version: '6.0'
  date: '2023-03-10T09:59:31Z'
  groups:
    -
      uuid: 57b7ae836ca64446ba2c296389c009b7
      name: Templates/Modules
    -
      uuid: b95b664ac4d54075a4df28ae45a0bdc5
      name: Templates/Modules/ZRNSMET
  templates:
    -
      uuid: 5d168c1146d646f5adf72b000f679b9f
      template: 'Template Module SNMP TCP-MIB - tcp'
      name: 'Template Module SNMP TCP-MIB - tcp'
      description: 'Generated by mib2zabbix'
      groups:
        -
          name: Templates/Modules
        -
          name: Templates/Modules/ZRNSMET
      items:
        -
          uuid: ca103de5d0a641dd8783f9cf97400e9d
          name: tcpActiveOpens
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.5.0
          key: TCP-MIB.tcpActiveOpens
          delay: '60'
          history: 30d
          units: /sec
          description: 'The number of times that TCP connections have made a direct transition to the SYN-SENT state from the CLOSED state. Discontinuities in the value of this counter are indicated via discontinuities in the value of sysUpTime.'
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: 7b50b0f2925c4e63b4fb7a6169c47855
          name: tcpAttemptFails
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.7.0
          key: TCP-MIB.tcpAttemptFails
          delay: '60'
          history: 30d
          units: /sec
          description: 'The number of times that TCP connections have made a direct transition to the CLOSED state from either the SYN-SENT state or the SYN-RCVD state, plus the number of times that TCP connections have made a direct transition to the LISTEN state from the SYN-RCVD state. Discontinuities in the value of this counter are indicated via discontinuities in the value of sysUpTime.'
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: 6a94537f0a66404f9aa2858e7f99065b
          name: tcpCurrEstab
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.9.0
          key: TCP-MIB.tcpCurrEstab
          delay: '60'
          history: 30d
          description: 'The number of TCP connections for which the current state is either ESTABLISHED or CLOSE-WAIT.'
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: 4a863c7eeba841e1a9974cf609ffa195
          name: tcpEstabResets
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.8.0
          key: TCP-MIB.tcpEstabResets
          delay: '60'
          history: 30d
          units: /sec
          description: 'The number of times that TCP connections have made a direct transition to the CLOSED state from either the ESTABLISHED state or the CLOSE-WAIT state. Discontinuities in the value of this counter are indicated via discontinuities in the value of sysUpTime.'
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: fca3558911b5424f87b7e6cbc26388cb
          name: tcpHCInSegs
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.17.0
          key: TCP-MIB.tcpHCInSegs
          delay: '60'
          history: 30d
          units: /sec
          description: 'The total number of segments received, including those received in error. This count includes segments received on currently established connections. This object is the 64-bit equivalent of tcpInSegs. Discontinuities in the value of this counter are indicated via discontinuities in the value of sysUpTime.'
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: 3a1bea7ed5194f00b56d5e8f386be41d
          name: tcpHCOutSegs
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.18.0
          key: TCP-MIB.tcpHCOutSegs
          delay: '60'
          history: 30d
          units: /sec
          description: 'The total number of segments sent, including those on current connections but excluding those containing only retransmitted octets. This object is the 64-bit equivalent of tcpOutSegs. Discontinuities in the value of this counter are indicated via discontinuities in the value of sysUpTime.'
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: 1513185a871d44f88d61e96f9fe86c33
          name: tcpInErrs
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.14.0
          key: TCP-MIB.tcpInErrs
          delay: '60'
          history: 30d
          units: /sec
          description: 'The total number of segments received in error (e.g., bad TCP checksums). Discontinuities in the value of this counter are indicated via discontinuities in the value of sysUpTime.'
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: 3909eab2d43a4eedb9e349d63d0c4647
          name: tcpInSegs
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.10.0
          key: TCP-MIB.tcpInSegs
          delay: '60'
          history: 30d
          units: /sec
          description: 'The total number of segments received, including those received in error. This count includes segments received on currently established connections. Discontinuities in the value of this counter are indicated via discontinuities in the value of sysUpTime.'
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: 91f7bac402474ae9ac77d0903ba78811
          name: tcpMaxConn
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.4.0
          key: TCP-MIB.tcpMaxConn
          delay: 1d
          history: 30d
          value_type: FLOAT
          description: 'The limit on the total number of TCP connections the entity can support. In entities where the maximum number of connections is dynamic, this object should contain the value -1.'
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: b61e413e0e404270a74e81a600feca6b
          name: tcpOutRsts
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.15.0
          key: TCP-MIB.tcpOutRsts
          delay: '60'
          history: 30d
          units: /sec
          description: 'The number of TCP segments sent containing the RST flag. Discontinuities in the value of this counter are indicated via discontinuities in the value of sysUpTime.'
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: c9fb9efcad7449e48c2532c647e3652e
          name: tcpOutSegs
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.11.0
          key: TCP-MIB.tcpOutSegs
          delay: '60'
          history: 30d
          units: /sec
          description: 'The total number of segments sent, including those on current connections but excluding those containing only retransmitted octets. Discontinuities in the value of this counter are indicated via discontinuities in the value of sysUpTime.'
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: 34ce6b0719394271a454c93e426c225c
          name: tcpPassiveOpens
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.6.0
          key: TCP-MIB.tcpPassiveOpens
          delay: '60'
          history: 30d
          units: /sec
          description: 'The number of times TCP connections have made a direct transition to the SYN-RCVD state from the LISTEN state. Discontinuities in the value of this counter are indicated via discontinuities in the value of sysUpTime.'
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: 8c3a7147e2544efc8c463cd68c97a69e
          name: tcpRetransSegs
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.12.0
          key: TCP-MIB.tcpRetransSegs
          delay: '60'
          history: 30d
          units: /sec
          description: 'The total number of segments retransmitted; that is, the number of TCP segments transmitted containing one or more previously transmitted octets. Discontinuities in the value of this counter are indicated via discontinuities in the value of sysUpTime.'
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: d94de529d9ae422f94f9c553bf070b4e
          name: tcpRtoAlgorithm
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.1.0
          key: TCP-MIB.tcpRtoAlgorithm
          delay: 1d
          history: 30d
          value_type: FLOAT
          description: 'The algorithm used to determine the timeout value used for retransmitting unacknowledged octets.'
          valuemap:
            name: 'TCP-MIB::tcpRtoAlgorithm'
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: 88663460e30d4971800038d457c825f7
          name: tcpRtoMax
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.3.0
          key: TCP-MIB.tcpRtoMax
          delay: 1d
          history: 30d
          value_type: FLOAT
          units: s
          description: 'The maximum value permitted by a TCP implementation for the retransmission timeout, measured in milliseconds. More refined semantics for objects of this type depend on the algorithm used to determine the retransmission timeout; in particular, the IETF standard algorithm rfc2988(5) provides an upper bound (as part of an adaptive backoff algorithm).'
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '.001'
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
        -
          uuid: a6bd142258fb4917b2e34c175346cd18
          name: tcpRtoMin
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.6.2.0
          key: TCP-MIB.tcpRtoMin
          delay: 1d
          history: 30d
          value_type: FLOAT
          units: s
          description: 'The minimum value permitted by a TCP implementation for the retransmission timeout, measured in milliseconds. More refined semantics for objects of this type depend on the algorithm used to determine the retransmission timeout; in particular, the IETF standard algorithm rfc2988(5) provides a minimum value.'
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '.001'
          tags:
            -
              tag: Application
              value: 'TCP-MIB::tcp'
      discovery_rules:
        -
          uuid: 261fb66e234b4a3fa6a151926de1e733
          name: 'tcpConnEntry Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#TCPCONNREMPORT},.1.3.6.1.2.1.6.13.1.5,{#TCPCONNREMADDRESS},.1.3.6.1.2.1.6.13.1.4,{#TCPCONNLOCALPORT},.1.3.6.1.2.1.6.13.1.3,{#TCPCONNLOCALADDRESS},.1.3.6.1.2.1.6.13.1.2,{#TCPCONNSTATE},.1.3.6.1.2.1.6.13.1.1]'
          key: TCP-MIB.tcpConnEntry
          delay: '3600'
          description: 'A conceptual row of the tcpConnTable containing information about a particular current IPv4 TCP connection. Each row of this table is transient in that it ceases to exist when (or soon after) the connection makes the transition to the CLOSED state.'
          item_prototypes:
            -
              uuid: be6eb5fcb40d4693a287651e119acd6f
              name: 'tcpConnLocalAddress for {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.6.13.1.2.{#SNMPINDEX}'
              key: 'tcpConnLocalAddress[{#SNMPINDEX}]'
              delay: 1d
              history: 30d
              trends: '0'
              value_type: TEXT
              description: 'The local IP address for this TCP connection. In the case of a connection in the listen state willing to accept connections for any IP interface associated with the node, the value 0.0.0.0 is used.'
              tags:
                -
                  tag: Application
                  value: 'TCP-MIB::tcp'
            -
              uuid: 30877ab210314844b09887342ecc13b7
              name: 'tcpConnLocalPort for {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.6.13.1.3.{#SNMPINDEX}'
              key: 'tcpConnLocalPort[{#SNMPINDEX}]'
              delay: 1d
              history: 30d
              value_type: FLOAT
              description: 'The local port number for this TCP connection.'
              tags:
                -
                  tag: Application
                  value: 'TCP-MIB::tcp'
            -
              uuid: 43189963b93a4c5bae7287b20503860d
              name: 'tcpConnRemAddress for {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.6.13.1.4.{#SNMPINDEX}'
              key: 'tcpConnRemAddress[{#SNMPINDEX}]'
              delay: 1d
              history: 30d
              trends: '0'
              value_type: TEXT
              description: 'The remote IP address for this TCP connection.'
              tags:
                -
                  tag: Application
                  value: 'TCP-MIB::tcp'
            -
              uuid: 5c6d10794d1c4c3e9aa010f41d29721b
              name: 'tcpConnRemPort for {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.6.13.1.5.{#SNMPINDEX}'
              key: 'tcpConnRemPort[{#SNMPINDEX}]'
              delay: 1d
              history: 30d
              value_type: FLOAT
              description: 'The remote port number for this TCP connection.'
              tags:
                -
                  tag: Application
                  value: 'TCP-MIB::tcp'
            -
              uuid: 120e2eb0de894a56bb5024d088d6ff79
              name: 'tcpConnState for {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.6.13.1.1.{#SNMPINDEX}'
              key: 'tcpConnState[{#SNMPINDEX}]'
              delay: '60'
              history: 30d
              value_type: FLOAT
              description: 'The state of this TCP connection. The only value that may be set by a management station is deleteTCB(12). Accordingly, it is appropriate for an agent to return a `badValue'' response if a management station attempts to set this object to any other value. If a management station sets this object to the value deleteTCB(12), then the TCB (as defined in [RFC793]) of the corresponding connection on the managed node is deleted, resulting in immediate termination of the connection. As an implementation-specific option, a RST segment may be sent from the managed node to the other TCP endpoint (note, however, that RST segments are not sent reliably).'
              valuemap:
                name: 'TCP-MIB::tcpConnState'
              tags:
                -
                  tag: Application
                  value: 'TCP-MIB::tcp'
      macros:
        -
          macro: '{$MIB2ZABBIX_CMD}'
          value: 'mib2zabbix -o .1.3.6.1.2.1.6 -v 2 -f tcpmibtcp.xml'
        -
          macro: '{$OID}'
          value: .1.3.6.1.2.1.6
        -
          macro: '{$OID_MOD}'
          value: TCP-MIB
        -
          macro: '{$OID_PATH}'
          value: iso.org.dod.internet.mgmt.mib-2.tcp
        -
          macro: '{$SNMP_COMMUNITY}'
          value: public
        -
          macro: '{$SNMP_PORT}'
          value: '161'
      valuemaps:
        -
          uuid: 64fb72b5e9644435805983227ee1c266
          name: 'IPV6-TCP-MIB::ipv6TcpConnState'
          mappings:
            -
              value: '7'
              newvalue: finWait2
            -
              value: '3'
              newvalue: synSent
            -
              value: '5'
              newvalue: established
            -
              value: '4'
              newvalue: synReceived
            -
              value: '8'
              newvalue: closeWait
            -
              value: '1'
              newvalue: closed
            -
              value: '2'
              newvalue: listen
            -
              value: '10'
              newvalue: closing
            -
              value: '6'
              newvalue: finWait1
            -
              value: '9'
              newvalue: lastAck
            -
              value: '11'
              newvalue: timeWait
            -
              value: '12'
              newvalue: deleteTCB
        -
          uuid: 2d3f5a6f192e405a9b9d1a7ab1c89343
          name: 'TCP-MIB::tcpConnectionState'
          mappings:
            -
              value: '2'
              newvalue: listen
            -
              value: '1'
              newvalue: closed
            -
              value: '6'
              newvalue: finWait1
            -
              value: '10'
              newvalue: closing
            -
              value: '12'
              newvalue: deleteTCB
            -
              value: '11'
              newvalue: timeWait
            -
              value: '9'
              newvalue: lastAck
            -
              value: '7'
              newvalue: finWait2
            -
              value: '4'
              newvalue: synReceived
            -
              value: '8'
              newvalue: closeWait
            -
              value: '3'
              newvalue: synSent
            -
              value: '5'
              newvalue: established
        -
          uuid: 52ffbf1c6c554a5e8138540f8680a206
          name: 'TCP-MIB::tcpConnState'
          mappings:
            -
              value: '2'
              newvalue: listen
            -
              value: '1'
              newvalue: closed
            -
              value: '6'
              newvalue: finWait1
            -
              value: '10'
              newvalue: closing
            -
              value: '12'
              newvalue: deleteTCB
            -
              value: '11'
              newvalue: timeWait
            -
              value: '9'
              newvalue: lastAck
            -
              value: '7'
              newvalue: finWait2
            -
              value: '4'
              newvalue: synReceived
            -
              value: '8'
              newvalue: closeWait
            -
              value: '3'
              newvalue: synSent
            -
              value: '5'
              newvalue: established
        -
          uuid: 9a2e976e081a43c0a680867b97ae8a8b
          name: 'TCP-MIB::tcpRtoAlgorithm'
          mappings:
            -
              value: '1'
              newvalue: other
            -
              value: '4'
              newvalue: vanj
            -
              value: '2'
              newvalue: constant
            -
              value: '5'
              newvalue: rfc2988
            -
              value: '3'
              newvalue: rsre
